<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Smoke Test â€” Banderas WebGL (Nilson)</title>
<style>
  :root{color-scheme:dark}
  body{margin:0;background:#0f1115;color:#e8e8e8;font-family:system-ui,Segoe UI,Roboto,Arial}
  header{display:flex;gap:12px;align-items:center;flex-wrap:wrap;padding:14px 16px;border-bottom:1px solid #222}
  h1{margin:0;font-size:18px}
  .pill{padding:4px 8px;border:1px solid #2a2f36;border-radius:999px;background:#171b20}
  select{background:#171b20;border:1px solid #2a2f36;color:#e8e8e8;border-radius:10px;padding:8px 10px}
  #wrap{display:flex;justify-content:center;align-items:center;padding:16px}
  canvas{max-width:96vw;max-height:80vh;border-radius:12px;box-shadow:0 12px 34px rgba(0,0,0,.5)}
</style>
</head>
<body>
<header>
  <h1>ðŸ§ª Smoke Test â€” Banderas WebGL</h1>
  <span class="pill">Autor: Nilson</span>
  <label class="pill" for="sel">PaÃ­s:</label>
  <select id="sel"></select>
</header>
<div id="wrap"><canvas id="lienzo" width="900" height="600"></canvas></div>

<script>
const BLANCO=[1,1,1], NEGRO=[.05,.05,.05];
const PRESETS={
  "PerÃº": {ratio:[2,3],orientation:"vertical",cuts:[1/3,2/3],colors:[[.78,0,.08],BLANCO,[.78,0,.08]]},
  "PaÃ­ses Bajos": {ratio:[2,3],orientation:"horizontal",cuts:[1/3,2/3],colors:[[.80,.15,.15],BLANCO,[.10,.20,.60]]},
  "Nigeria": {ratio:[1,2],orientation:"vertical",cuts:[1/3,2/3],colors:[[0,.48,.36],BLANCO,[0,.48,.36]]},
  "Rusia": {ratio:[2,3],orientation:"horizontal",cuts:[1/3,2/3],colors:[BLANCO,[.10,.35,.80],[.85,.20,.20]]},
  "Malaui": { // negro/rojo/verde (sol omitido)
    ratio:[2,3], orientation:"horizontal",
    cuts:[1/3, 2/3],
    colors:[NEGRO, [0.75,0.00,0.10], [0.00,0.49,0.20]]
  },
  "PerÃº": {
    ratio: [2, 3], orientation: "vertical",
    cuts: [1/3, 2/3],
    colors: [[0.78, 0.00, 0.08], BLANCO, [0.78, 0.00, 0.08]]
  },
  "CanadÃ¡": { // hoja omitida
    ratio: [1, 2], orientation: "vertical",
    cuts: [0.25, 0.75],
    colors: [[0.85, 0.05, 0.10], BLANCO, [0.85, 0.05, 0.10]]
  },

  // â€” Ãfrica â€”
  "Malaui": { // sol omitido
    ratio: [2, 3], orientation: "horizontal",
    cuts: [1/3, 2/3],
    colors: [NEGRO, [0.75, 0.00, 0.10], [0.00, 0.49, 0.20]]
  },
  "Yibuti": { // triÃ¡ngulo/estrella omitidos
    ratio: [2, 3], orientation: "horizontal",
    cuts: [1/2],
    colors: [[0.48, 0.71, 0.90], [0.00, 0.50, 0.20]]
  },
  "Tanzania": { // diagonal real no se modela con franjas -> aproximaciÃ³n
    ratio: [2, 3], orientation: "horizontal",
    cuts: [0.34, 0.38, 0.62, 0.66],
    colors: [
      [0.00, 0.50, 0.20],          // verde
      [0.95, 0.85, 0.10],          // amarillo fino
      NEGRO,                       // banda negra
      [0.95, 0.85, 0.10],          // amarillo fino
      [0.00, 0.35, 0.65]           // azul
    ]
  },
  "Botsuana": {
    ratio: [2, 3], orientation: "horizontal",
    cuts: [0.42, 0.46, 0.54, 0.58],
    colors: [
      [0.50, 0.75, 0.90], BLANCO, NEGRO, BLANCO, [0.50, 0.75, 0.90]
    ]
  },
  "Ghana": { // estrella omitida
    ratio: [2, 3], orientation: "horizontal",
    cuts: [1/3, 2/3],
    colors: [[0.75, 0.10, 0.10], [0.95, 0.85, 0.10], [0.00, 0.45, 0.15]]
  },
  "Egipto": { // escudo omitido
    ratio: [2, 3], orientation: "horizontal",
    cuts: [1/3, 2/3],
    colors: [[0.80, 0.10, 0.10], BLANCO, NEGRO]
  },
  "RepÃºblica Centroafricana": { // barra roja vertical y estrella omitidas
    ratio: [3, 5], orientation: "horizontal",
    cuts: [0.25, 0.50, 0.75],
    colors: [[0.00, 0.25, 0.65], BLANCO, [0.00, 0.55, 0.20], [0.95, 0.85, 0.10]]
  },
  "Nigeria": {
    ratio: [1, 2], orientation: "vertical",
    cuts: [1/3, 2/3],
    colors: [[0.00, 0.48, 0.36], BLANCO, [0.00, 0.48, 0.36]]
  },
  "Comoras": { // triÃ¡ngulo/luna/estrellas omitidos
    ratio: [2, 3], orientation: "horizontal",
    cuts: [0.25, 0.50, 0.75],
    colors: [[0.95, 0.85, 0.10], BLANCO, [0.85, 0.10, 0.15], [0.00, 0.35, 0.65]]
  },
  "Kenia": { // escudo/lanzas omitidos
    ratio: [2, 3], orientation: "horizontal",
    cuts: [0.28, 0.32, 0.68, 0.72],
    colors: [NEGRO, BLANCO, [0.75, 0.00, 0.10], BLANCO, [0.00, 0.45, 0.15]]
  },
  "RepÃºblica del Congo": {
    ratio: [2, 3], orientation: "horizontal",
    cuts: [1/3, 2/3],
    colors: [[0.00, 0.55, 0.20], [0.95, 0.85, 0.10], [0.85, 0.10, 0.10]]
  },
  "Chad": {
    ratio: [2, 3], orientation: "vertical",
    cuts: [1/3, 2/3],
    colors: [[0.00, 0.20, 0.55], [0.95, 0.85, 0.10], [0.80, 0.10, 0.10]]
  },

  // â€” Asia y OceanÃ­a â€”
  "Nauru": { // franja amarilla central muy fina (estrella omitida)
    ratio: [1, 2], orientation: "horizontal",
    cuts: [0.48, 0.52],
    colors: [[0.00, 0.20, 0.55], [0.95, 0.85, 0.10], [0.00, 0.20, 0.55]]
  },
  "Birmania (Myanmar)": { // estrella omitida
    ratio: [2, 3], orientation: "horizontal",
    cuts: [1/3, 2/3],
    colors: [[0.95, 0.80, 0.15], [0.00, 0.55, 0.25], [0.85, 0.10, 0.10]]
  },
  "Yemen": {
    ratio: [2, 3], orientation: "horizontal",
    cuts: [1/3, 2/3],
    colors: [[0.80, 0.10, 0.10], BLANCO, NEGRO]
  },
  "Vietnam": { // estrella omitida
    ratio: [2, 3], orientation: "horizontal",
    cuts: [],
    colors: [[0.80, 0.10, 0.10]]
  },
  "PakistÃ¡n": { // luna/estrella omitidas
    ratio: [2, 3], orientation: "vertical",
    cuts: [0.25],
    colors: [BLANCO, [0.00, 0.42, 0.28]]
  },
  "India": { // rueda omitida
    ratio: [2, 3], orientation: "horizontal",
    cuts: [1/3, 2/3],
    colors: [[0.95, 0.55, 0.10], BLANCO, [0.07, 0.46, 0.18]]
  },
  "Malasia": { // canton/astros omitidos; 6 franjas alternadas (aprox)
    ratio: [1, 2], orientation: "horizontal",
    cuts: [1/6, 2/6, 3/6, 4/6, 5/6],
    colors: [
      [0.80, 0.10, 0.10], BLANCO,
      [0.80, 0.10, 0.10], BLANCO,
      [0.80, 0.10, 0.10], BLANCO
    ]
  },
  "KirguistÃ¡n": { // emblema omitido
    ratio: [3, 5], orientation: "horizontal",
    cuts: [],
    colors: [[0.85, 0.00, 0.10]]
  },

  // â€” Europa â€”
  "PaÃ­ses Bajos": {
    ratio: [2, 3], orientation: "horizontal",
    cuts: [1/3, 2/3],
    colors: [[0.80, 0.15, 0.15], BLANCO, [0.10, 0.20, 0.60]]
  },
  "Eslovenia": { // escudo omitido
    ratio: [1, 2], orientation: "horizontal",
    cuts: [1/3, 2/3],
    colors: [BLANCO, [0.05, 0.31, 0.64], [0.85, 0.10, 0.10]]
  },
  "Polonia": {
    ratio: [5, 8], orientation: "horizontal",
    cuts: [1/2],
    colors: [BLANCO, [0.85, 0.10, 0.10]]
  },
  "Rusia": {
    ratio: [2, 3], orientation: "horizontal",
    cuts: [1/3, 2/3],
    colors: [BLANCO, [0.10, 0.35, 0.80], [0.85, 0.20, 0.20]]
  },
  "Letonia": {
    ratio: [1, 2], orientation: "horizontal",
    cuts: [0.40, 0.60],
    colors: [[0.55, 0.10, 0.15], BLANCO, [0.55, 0.10, 0.15]]
  },
  "MÃ³naco": {
    ratio: [4, 5], orientation: "horizontal",
    cuts: [1/2],
    colors: [[0.85, 0.05, 0.10], BLANCO]
  }
}

// --- WebGL mÃ­nimo ---
const canvas=document.getElementById('lienzo');
const gl=canvas.getContext('webgl'); if(!gl){alert('WebGL off');}
const verts=new Float32Array([-1,-1,1,-1,-1,1, 1,-1,1,1,-1,1]);
const vbo=gl.createBuffer(); gl.bindBuffer(gl.ARRAY_BUFFER,vbo); gl.bufferData(gl.ARRAY_BUFFER,verts,gl.STATIC_DRAW);
const vs=`attribute vec2 a; varying vec2 v; void main(){v=(a+1.0)*0.5; gl_Position=vec4(a,0.0,1.0);} `;
const fs=`precision mediump float; varying vec2 v; uniform int H,N; uniform float C[7]; uniform vec3 K[8];
void main(){ float t=(H==1)?v.y:v.x; vec3 col=K[0];
if(N>0 && t>=C[0]) col=K[1]; if(N>1 && t>=C[1]) col=K[2]; if(N>2 && t>=C[2]) col=K[3];
if(N>3 && t>=C[3]) col=K[4]; if(N>4 && t>=C[4]) col=K[5]; if(N>5 && t>=C[5]) col=K[6];
if(N>6 && t>=C[6]) col=K[7]; gl_FragColor=vec4(col,1.0);} `;
function sh(t,s){const x=gl.createShader(t); gl.shaderSource(x,s); gl.compileShader(x);
if(!gl.getShaderParameter(x,gl.COMPILE_STATUS)) throw gl.getShaderInfoLog(x); return x;}
const p=gl.createProgram(); gl.attachShader(p,sh(gl.VERTEX_SHADER,vs)); gl.attachShader(p,sh(gl.FRAGMENT_SHADER,fs)); gl.linkProgram(p);
if(!gl.getProgramParameter(p,gl.LINK_STATUS)) throw gl.getProgramInfoLog(p); gl.useProgram(p);
const a=gl.getAttribLocation(p,'a'); gl.enableVertexAttribArray(a); gl.vertexAttribPointer(a,2,gl.FLOAT,false,0,0);
const uH=gl.getUniformLocation(p,'H'), uN=gl.getUniformLocation(p,'N'), uC=gl.getUniformLocation(p,'C'), uK=gl.getUniformLocation(p,'K');

function viewportRatio([alto,ancho]){const maxW=Math.min(1000,innerWidth*.96), maxH=Math.min(800,innerHeight*.8);
let w=maxW,h=w*(alto/ancho); if(h>maxH){h=maxH; w=h*(ancho/alto);} canvas.width=w|0; canvas.height=h|0; gl.viewport(0,0,canvas.width,canvas.height);}

function draw(preset){
  viewportRatio(preset.ratio);
  gl.uniform1i(uH, preset.orientation==='horizontal'?1:0);
  const cuts=(preset.cuts||[]).slice(0,7), arr7=new Float32Array(7); cuts.forEach((c,i)=>arr7[i]=c);
  gl.uniform1i(uN, cuts.length); gl.uniform1fv(uC, arr7);
  const col=new Float32Array(24); for(let i=0;i<cuts.length+1;i++){const c=preset.colors[i]; col.set([c[0],c[1],c[2]], i*3);}
  gl.uniform3fv(uK,col); gl.clearColor(0,0,0,1); gl.clear(gl.COLOR_BUFFER_BIT); gl.drawArrays(gl.TRIANGLES,0,6);
}

// UI
const sel=document.getElementById('sel'); Object.keys(PRESETS).forEach(n=>{const o=document.createElement('option');o.value=o.textContent=n; sel.appendChild(o);});
sel.value='PerÃº'; draw(PRESETS[sel.value]); sel.onchange=()=>draw(PRESETS[sel.value]); addEventListener('resize',()=>draw(PRESETS[sel.value]));
</script>
</body>
</html>
